<!DOCTYPE html>
<html lang="en">
  <head>
    <title>BEM â€” Building</title>
    <link rel="icon" type="image/png" href="favicon.png">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="building.css">
  </head>
  <body class="page">
    <div class="menu"><a href="index.html" class="menu__heading">Get BEM</a><a href="getting-started.html" class="menu__item">Getting started</a><a href="naming.html" class="menu__item">Naming</a><a href="structure.html" class="menu__item">Structure</a><a href="building.html" class="menu__item">Building</a></div>
    <div class="grid">
      <div class="grid__row">
        <div class="grid__cell-xs_size_12 markdown"><h1 id="building">Building</h1>
<p>Now you have structured project with BEM in mind:</p>
<pre><code>vendor/
    pure-grids/
        grid/
            __col/
                grid__col.css
            grid.css
blocks/
    form/
        __input/
            form__input.css
        __submit/
            form__submit.css
        __submit/
            _disabled/
                form__submit_disable.css
    page/
        page.css
index.css
</code></pre><p>It is quite a lot of CSS files, if you compare to one <code>index.css</code>. Lets build them together! For building we will use <a href="https://github.com/gulpjs/gulp">gulpjs</a> - it is simple streaming build system.</p>
<pre><code class="lang-bash">npm install gulp -g
</code></pre>
<p>All build configurations for gulp is stored in <code>gulpfile.js</code> in the root of the project:</p>
<pre><code class="lang-js">var gulp = require(&#39;gulp&#39;);
</code></pre>
<p>As you can see, we will write our build configuration in JavaScript. gulp has nice API, that allows you to get files quick and easy.</p>
<h2 id="building-css">Building CSS</h2>
<p>Since BEM is methodology of non-dependent blocks without CSS cascading problems we can take CSS files and concatenate them with <a href="https://github.com/wearefractal/gulp-concat">gulp-concat</a> plugin (there are more than <a href="http://gulpjs.com/plugins/">600 plugins</a> for now):</p>
<pre><code class="lang-js">var gulp = require(&#39;gulp&#39;);
var concat = require(&#39;gulp-concat&#39;);

gulp.task(&#39;default&#39;, function () {
    return gulp.src([&#39;vendor/**/*.css&#39;, &#39;blocks/**/*.css&#39;])
        .pipe(concat(&#39;index.css&#39;))
        .pipe(gulp.dest(&#39;dist&#39;));
});
</code></pre>
<p>Gulp file is ready. Time to install dependencies:</p>
<pre><code class="lang-bash">npm i --save gulp gulp-concat
</code></pre>
<p>Now if you will type <code>gulp</code> in command line, you will build <code>index.css</code> file in <code>dist</code> directory. Your CSS is ready!</p>
<h2 id="building-javascript">Building JavaScript</h2>
<p>There are two ways to organize your JavaScript code: <a href="https://wikipedia.org/wiki/Asynchronous_module_definition">AMD</a> and <a href="https://en.wikipedia.org/wiki/CommonJS">CommonJS</a>. Both of them have they own advantages and downsides.</p>
<h3 id="amd">AMD</h3>
<p>For AMD way you will need some prelude JavaScript file, that will handle definitions of modules. For example sample <a href="http://requirejs.org/">RequireJS</a> module will look like this:</p>
<pre><code class="lang-js">require([&quot;helper/util&quot;], function(util) {
    /* Your code gose here */
});
</code></pre>
<p>It can differ for concrete AMD module, but main idea is same. <code>require</code> function is loaded from prelude file. All you need is concatinate all yours JavaScript files after this special <code>prelude.js</code> file:</p>
<pre><code class="lang-js">var gulp = require(&#39;gulp&#39;);
var concat = require(&#39;gulp-concat&#39;);

gulp.task(&#39;default&#39;, function () {
    return gulp.src([&#39;lib/prelude.js&#39;, &#39;vendor/**/*.js&#39;, &#39;blocks/**/*.js&#39;])
        .pipe(concat(&#39;index.js&#39;))
        .pipe(gulp.dest(&#39;dist&#39;));
});
</code></pre>
<p>Keep in mind, that RequireJS is not suited for BEM levels.</p>
<h3 id="commonjs">CommonJS</h3>
<p>In other hand, CommonJS style does not requires special <code>prelude.js</code> file (but it will add <code>require</code> definition in resulting file). Example JavaScript file written in CommonJS style looks like this:</p>
<pre><code class="lang-js">var util = require(&quot;helper/util&quot;);

/* Your code gose here */
</code></pre>
<p>It a bit more straight forward, but it is quite hard to implement async loading of dependencies in CommonJS. But if you don&#39;t need them - it is good choise. We will build <code>index.js</code> with <a href="http://browserify.org/">browserify</a> wrapper <a href="https://github.com/floatdrop/gulp-bem-pack">gulp-bem-pack</a>:</p>
<pre><code class="lang-js">var gulp = require(&#39;gulp&#39;);
var bempack = require(&#39;gulp-bem-pack&#39;);

gulp.task(&#39;default&#39;, function () {
    gulp.src([&#39;base/**/*.js&#39;, &#39;main/**/*.js&#39;])
        .pipe(bempack(&#39;index.js&#39;))
        .pipe(gulp.dest(&#39;dist&#39;));
});
</code></pre>
<p>You can build your JavaScript with bare browserify plugin, but you will have to handle path resolving, which is handled by <a href="https://github.com/floatdrop/gulp-bem-pack">bem-pack</a> in this example. JavaScript is ready to go!</p>
<h2 id="building-templates">Building Templates</h2>
<p>This is most complex part, because you can&#39;t just concatinate HTML files and template engine often will not support you in this task. We will demonstrate how to build Jade templates with help of Jade mixins to get something like custom blocks.</p>
<p>First we create <code>index.jade</code> file with next content:</p>
<pre><code class="lang-jade">html
  head
    title Hello BEM!
  body
    +header(&#39;Title of header&#39;)
      p content of header
</code></pre>
<p>Jade has pretty neat and powerful syntax, which very attractive against other alternatives. Now we have to load <code>+header</code> from <code>base/header/header.jade</code>:</p>
<pre><code class="lang-jade">+header(title)
  h1
    =title
  code
    block
</code></pre>
<p>Now it is time to build it:</p>
<pre><code class="lang-js">var gulp = require(&#39;gulp&#39;);
var jade = require(&#39;gulp-jade&#39;);
var concat = require(&#39;gulp-concat&#39;);

gulp.task(&#39;default&#39;, function () {
    gulp.src([&#39;base/**/*.jade&#39;, &#39;index.jade&#39;])
        .pipe(concat(&#39;index.jade&#39;))
        .pipe(jade({pretty: true}))
        .pipe(gulp.dest(&#39;dist&#39;));
});
</code></pre>
<p>Jade is not well suited for mixin extension, but for small projects it is a very good start.</p>

        </div>
      </div>
    </div>
    <div class="container">
      <div class="edit"><a href="https://github.com/floatdrop/getbem.com/edit/master/pages/building/building.md" data-style="mega" data-icon="octicon-git-branch" class="github-button">Edit this page</a></div>
    </div>
  </body>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
     
    ga('create', 'UA-15345174-10', 'auto');
    ga('send', 'pageview');
  </script>
  <script>
    var _gauges = _gauges || [];
    (function() {
      var t   = document.createElement('script');
      t.type  = 'text/javascript';
      t.async = true;
      t.id    = 'gauges-tracker';
      t.setAttribute('data-site-id', '54070a998bfdf7145100b613');
      t.src = '//secure.gaug.es/track.js';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(t, s);
    })();
  </script>
  <script id="github-bjs" async defer src="https://buttons.github.io/buttons.js"></script>
  <script src="index.js"></script>
</html>